 Categories (if mvtec_dataset exists): []
Dataset shape: (10000, 14)
   UDI Product ID Type  Air temperature [K]  Process temperature [K]  \
0    1     M14860    M                298.1                    308.6   
1    2     L47181    L                298.2                    308.7   
2    3     L47182    L                298.1                    308.5   
3    4     L47183    L                298.2                    308.6   
4    5     L47184    L                298.2                    308.7   

   Rotational speed [rpm]  Torque [Nm]  Tool wear [min]  Machine failure  TWF  \
0                    1551         42.8                0                0    0   
1                    1408         46.3                3                0    0   
2                    1498         49.4                5                0    0   
3                    1433         39.5                7                0    0   
4                    1408         40.0                9                0    0   

   HDF  PWF  OSF  RNF  
0    0    0    0    0  
1    0    0    0    0  
2    0    0    0    0  
3    0    0    0    0  
4    0    0    0    0  
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 10000 entries, 0 to 9999
Data columns (total 14 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   UDI                      10000 non-null  int64  
 1   Product ID               10000 non-null  object 
 2   Type                     10000 non-null  object 
 3   Air temperature [K]      10000 non-null  float64
 4   Process temperature [K]  10000 non-null  float64
 5   Rotational speed [rpm]   10000 non-null  int64  
 6   Torque [Nm]              10000 non-null  float64
 7   Tool wear [min]          10000 non-null  int64  
 8   Machine failure          10000 non-null  int64  
 9   TWF                      10000 non-null  int64  
 10  HDF                      10000 non-null  int64  
 11  PWF                      10000 non-null  int64  
 12  OSF                      10000 non-null  int64  
 13  RNF                      10000 non-null  int64  
dtypes: float64(3), int64(9), object(2)
memory usage: 1.1+ MB
UDI                        0
Product ID                 0
Type                       0
Air temperature [K]        0
Process temperature [K]    0
Rotational speed [rpm]     0
Torque [Nm]                0
Tool wear [min]            0
Machine failure            0
TWF                        0
HDF                        0
PWF                        0
OSF                        0
RNF                        0
dtype: int64
Calculated Outlier Bounds for Each Feature:
  Air temperature [K]:
    Lower Bound: 293.50
    Upper Bound: 306.30
  Process temperature [K]:
    Lower Bound: 305.35
    Upper Bound: 314.55
  Rotational speed [rpm]:
    Lower Bound: 1139.50
    Upper Bound: 1895.50
  Torque [Nm]:
    Lower Bound: 12.80
    Upper Bound: 67.20
  Tool wear [min]:
    Lower Bound: -110.50
    Upper Bound: 325.50
Outliers capped for the following features:
- Air temperature [K]
- Process temperature [K]
- Rotational speed [rpm]
- Torque [Nm]
- Tool wear [min]
Visualized distributions of features after outlier capping.
Train shape: (8000, 5) Test shape: (2000, 5)
Accuracy: 97.55
Classification Report:
               precision    recall  f1-score   support

           0       0.98      1.00      0.99      1939
           1       0.77      0.28      0.41        61

    accuracy                           0.98      2000
   macro avg       0.88      0.64      0.70      2000
weighted avg       0.97      0.98      0.97      2000

Confusion Matrix:
 [[1934    5]
 [  44   17]]
/tmp/ipython-input-3538234397.py:175: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(x='Importance', y='Feature', data=feat_df, palette='coolwarm')

Descriptive Statistics of Numerical Features after Outlier Capping:
       Air temperature [K]  Process temperature [K]  Rotational speed [rpm]  \
count         10000.000000             10000.000000            10000.000000   
mean            300.004930               310.005560             1530.142500   
std               2.000259                 1.483734              148.798499   
min             295.300000               305.700000             1168.000000   
25%             298.300000               308.800000             1423.000000   
50%             300.100000               310.100000             1503.000000   
75%             301.500000               311.100000             1612.000000   
max             304.500000               313.800000             1895.500000   

        Torque [Nm]  Tool wear [min]  
count  10000.000000     10000.000000  
mean      39.983490       107.951000  
std        9.914623        63.654147  
min       12.800000         0.000000  
25%       33.200000        53.000000  
50%       40.100000       108.000000  
75%       46.800000       162.000000  
max       67.200000       253.000000  

First 5 rows of DataFrame after Outlier Capping:
   Air temperature [K]  Process temperature [K]  Rotational speed [rpm]  \
0                298.1                    308.6                  1551.0   
1                298.2                    308.7                  1408.0   
2                298.1                    308.5                  1498.0   
3                298.2                    308.6                  1433.0   
4                298.2                    308.7                  1408.0   

   Torque [Nm]  Tool wear [min]  
0         42.8                0  
1         46.3                3  
2         49.4                5  
3         39.5                7  
4         40.0                9  

Shape of the scaled feature array (X):
(10000, 5)

First 5 rows of the scaled feature array (X):
[[-9.52389443e-01 -9.47359888e-01  1.40179794e-01  2.84090571e-01
  -1.69598374e+00]
 [-9.02393410e-01 -8.79959002e-01 -8.20899458e-01  6.37122158e-01
  -1.64885170e+00]
 [-9.52389443e-01 -1.01476077e+00 -2.16024405e-01  9.49807279e-01
  -1.61743034e+00]
 [-9.02393410e-01 -9.47359888e-01 -6.52878610e-01 -4.87677835e-02
  -1.58600898e+00]
 [-9.02393410e-01 -8.79959002e-01 -8.20899458e-01  1.66530043e-03
  -1.55458761e+00]]

--- Identifying Categorical Features ---

Feature: Type
Unique values: 3
Value counts:
Type
L    6000
M    2997
H    1003
Name: count, dtype: int64

Feature: Product ID
Unique values: 10000
Value counts:
Product ID
L57163    1
M24842    1
L57161    1
L57160    1
L57159    1
         ..
L47184    1
L47183    1
L47182    1
L47181    1
M14860    1
Name: count, Length: 10000, dtype: int64

--- Class Distribution of 'Machine failure' ---
Value Counts:
 Machine failure
0    9661
1     339
Name: count, dtype: int64

Percentage of Each Class:
 Machine failure
0    96.61
1     3.39
Name: proportion, dtype: float64

Total instances: 10000
Visualized the distribution of the 'Machine failure' target variable.

--- KNN Model Performance Metrics ---
Accuracy: 97.55%
Classification Report:
               precision    recall  f1-score   support

           0       0.98      1.00      0.99      1939
           1       0.77      0.28      0.41        61

    accuracy                           0.98      2000
   macro avg       0.88      0.64      0.70      2000
weighted avg       0.97      0.98      0.97      2000

Confusion Matrix:
 [[1934    5]
 [  44   17]]
AUC-ROC: 0.8350
Specificity: 0.9974

Interpretation of Specificity:
Specificity measures the proportion of actual negative cases (No Failure) that were correctly identified by the model.
In this case, a Specificity of 0.9974 means that 99.74% of the actual 'No Failure' instances were correctly predicted as 'No Failure' by the model.
This is generally high because the model performs very well on the majority class.
Generated and displayed the correlation matrix heatmap.
Generated and displayed violin plots for numerical features by 'Machine failure' status.
K-Fold cross-validator initialized with 5 splits.
Metric lists created to store results from each fold.

--- Fold 1/5 ---
Accuracy: 0.9755
Precision (Class 1): 0.7727
Recall (Class 1): 0.2787
F1-score (Class 1): 0.4096
AUC-ROC: 0.8350
Specificity: 0.9974

--- Fold 2/5 ---
Accuracy: 0.9740
Precision (Class 1): 0.8077
Recall (Class 1): 0.3088
F1-score (Class 1): 0.4468
AUC-ROC: 0.8872
Specificity: 0.9974

--- Fold 3/5 ---
Accuracy: 0.9710
Precision (Class 1): 0.8214
Recall (Class 1): 0.3026
F1-score (Class 1): 0.4423
AUC-ROC: 0.8899
Specificity: 0.9974

--- Fold 4/5 ---
Accuracy: 0.9765
Precision (Class 1): 0.7727
Recall (Class 1): 0.2881
F1-score (Class 1): 0.4198
AUC-ROC: 0.8900
Specificity: 0.9974

--- Fold 5/5 ---
Accuracy: 0.9700
Precision (Class 1): 0.8261
Recall (Class 1): 0.2533
F1-score (Class 1): 0.3878
AUC-ROC: 0.8359
Specificity: 0.9979

Cross-validation complete. Metrics for each fold have been calculated and stored.

--- Cross-Validation Results (Mean +/- Std Dev) ---
Accuracy: 0.9734 +/- 0.0025
Precision (Class 1): 0.8001 +/- 0.0232
Recall (Class 1): 0.2863 +/- 0.0196
F1-score (Class 1): 0.4213 +/- 0.0217
AUC-ROC: 0.8676 +/- 0.0263
Specificity: 0.9975 +/- 0.0002
Mean and standard deviation of cross-validation metrics calculated and displayed.

